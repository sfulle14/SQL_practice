UPDATE tblCaseCharge
SET
CaseID = C.CaseID
,SAOCaseNumber = ,''A
,OffenseDate = ,TCC.Date_Of_ViolationA
,ArrestDate = ,TCC.Date_ArrestedA
,ArrestingAgencyID = ,C.AgencyIDA
,ArrestingCaseNumber = ,C.CaseNumberA
,OBTSNumber = ,''A
,CitationID = ,0A
,StatuteID = ,S.StatuteIDA
,EWHENISNULL(TCD.Date_Of_Sentence,CS.Date_Of_Sentence)ISNOTNULLTHEN'C'ELSE'I'ENDASChargePhase = ,CA
,SetBondAmount = ,ISNULL(BS.BondAmount,0)A
,InitialSequenceNumber = ,ISNULL(TRY_CONVERT(INT,CV.Counter),0)A
,InitialStatuteID = ,S.StatuteIDA
,EWHENTCC.Date_ArrestedISNOTNULLTHEN'F'WHENISNULL(TCC.Ticket_Number,'')>''THEN'CI'ELSE'P'ENDASInitialChargeStatus = ,CA
,InitialDrugType = ,''A
,InitialChargeWeapons = ,''A
,InitialChargeRange = ,''A
,InitialChargeAmount = ,0A
,InitialChargeUnit = ,''A
,InitialStatuteDescription = ,ISNULL(LTRIM(RTRIM(CV.Case_Violation_Description)),ISNULL(S.StatuteLongDescription,''))A
,EISNULL(SUBSTRING(LTRIM(RTRIM(DOV.Degree)),1,1),'')WHEN'U'THEN'F'ELSEISNULL(SUBSTRING(LTRIM(RTRIM(DOV.Degree)),1,1),'')ENDASInitialChargeLevel = ,CA
,InitialChargeDegree = ,ISNULL(LTRIM(RTRIM(DOV.Degree)),'')A
,InitialGeneralOffenseCharacter = ,''A
,InitialOffenseActivity = ,''A
,ProsecutorSequenceNumber = ,ISNULL(TRY_CONVERT(INT,CV.Counter),0)A
,ProsecutorStatuteID = ,0A
,ProsecutorChargeStatus = ,''A
,ProsecutorDrugType = ,''A
,ProsecutorChargeWeapons = ,''A
,ProsecutorChargeRange = ,''A
,ProsecutorChargeAmount = ,0A
,ProsecutorChargeUnit = ,''A
,ProsecutorFileDate = ,NULLA
,ProsecutorFinalDecisionDate = ,NULLA
,ProsecutorFinalAction = ,''A
,ProsecutorDefermentType = ,''A
,ProsecutorDefermentDate = ,NULLA
,ProsecutorStatuteDescription = ,''A
,ProsecutorChargeLevel = ,''A
,ProsecutorChargeDegree = ,''A
,ProsecutorGeneralOffenseCharacter = ,''A
,ProsecutorOffenseActivity = ,''A
,CourtSequenceNumber = ,ISNULL(TRY_CONVERT(INT,CV.Counter),0)A
,CourtStatuteID = ,SSNT.StatuteIDA
,EWHENSSNT.StatuteID=S.StatuteIDTHEN'S'ELSE''ENDASCourtChargeStatus = ,CA
,CourtDrugType = ,''A
,CourtChargeWeapons = ,''A
,CourtChargeRange = ,''A
,CourtChargeAmount = ,0A
,CourtChargeUnit = ,''A
,CourtDecisionDate = ,ISNULL(TCD.Date_Of_Sentence,CS.Date_Of_Sentence)A
,EWHENISNULL(LTRIM(RTRIM(SNT.Sentence_Code)),'')>''THENLTRIM(RTRIM(SNT.Sentence_Code))ELSECONVERT(VARCHAR(50),SNT.Sentence_Id)ENDASCourtActionTaken = ,CA
,CourtFinalPlea = ,LTRIM(RTRIM(PSNT.Plea_Code))A
,CourtFinalPlea = --,CONVERT(VARCHAR(50),PSNT.Plea_Id)A
,CourtFinalPleaEnteredDate = ,ISNULL(TCD.Date_Final_Plea,CS.Date_Of_Sentence)A
,EWHENSSNT.StatuteID=S.StatuteIDTHENISNULL(LTRIM(RTRIM(CV.Case_Violation_Description)),ISNULL(SSNT.StatuteLongDescription,''))ELSEISNULL(SSNT.StatuteLongDescription,'')ENDASCourtStatuteDescription = ,CA
,EISNULL(SUBSTRING(LTRIM(RTRIM(DOVSNT.Degree)),1,1),'')WHEN'U'THEN'F'ELSEISNULL(SUBSTRING(LTRIM(RTRIM(DOVSNT.Degree)),1,1),'')ENDASCourtChargeLevel = ,CA
,CourtChargeDegree = ,ISNULL(LTRIM(RTRIM(DOVSNT.Degree)),'')A
,CourtGeneralOffenseCharacter = ,''A
,CourtOffenseActivity = ,''A
,ReOpenDate = ,NULLA
,ReOpenReason = ,''A
,ReOpenedChargeClosedDate = ,NULLA
,AppealDate = ,NULLA
,ArrestPartyNameID = ,0A
,DispositionPartyNameID = ,0A
,SentenceImposedDate = ,ISNULL(TCD.Date_Of_Sentence,CS.Date_Of_Sentence)A
,SentenceEffectiveDate = ,ISNULL(TCD.Jail_From,CS.Jail_From)A
,JudgeID = ,C.JudgeIDA
,JurisdictionRetained = ,0A
,SentenceStatus = ,0A
,SentenceStatusCaseNumber = ,''A
,SentenceStatusChargeCount = ,0A
,SentenceNotes = ,LEFT(ISNULL(LTRIM(RTRIM(CS.Comments))+'','')+ISNULL(LTRIM(RTRIM(TCD.Suspension_Comments)),''),5000)A
,CourtDocketNumber = ,''A
,MinConfinementCode = ,''A
,MaxConfinementCode = ,''A
,MinConfinementYears = ,0A
,MinConfinementMonths = ,0A
,MinConfinementDays = ,0A
,MaxConfinementYears = ,0A
,MaxConfinementMonths = ,0A
,EWHENISNULL(TCD.Total_Jail,0)>0THENTCD.Total_JailELSEISNULL(CS.Jail_Days,0)ENDASMaxConfinementDays = ,CA
,OBTSMinConfinementYears = ,0A
,OBTSMinConfinementMonths = ,0A
,OBTSMinConfinementDays = ,0A
,OBTSMaxConfinementYears = ,0A
,OBTSMaxConfinementMonths = ,0A
,EWHENISNULL(TCD.Total_Jail,0)>0THENTCD.Total_JailELSEISNULL(CS.Jail_Days,0)ENDASOBTSMaxConfinementDays = ,CA
,EWHENISNULL(TCD.Total_Jail,0)>0THEN'C'WHENISNULL(CS.Jail_Days,0)>0THEN'C'ELSE''ENDASConfinementTypeCode = ,CA
,SuspendConfinementYears = ,0A
,SuspendConfinementMonths = ,0A
,EWHENISNULL(TCD.Suspended_Jail,0)>0THENTCD.Suspended_JailELSEISNULL(CS.Jail_Days_Suspended,0)ENDASSuspendConfinementDays = ,CA
,OBTSSuspendConfinementYears = ,0A
,OBTSSuspendConfinementMonths = ,0A
,OBTSSuspendConfinementDays = ,0A
,CreditTimeServedCode = ,''A
,CreditTimeServedYears = ,0A
,CreditTimeServedMonths = ,0A
,EWHENISNULL(TCD.Credit_Days,0)>0THENTCD.Credit_DaysELSEISNULL(CS.Jail_Days_In_Custody,0)ENDASCreditTimeServedDays = ,CA
,OBTSCreditTimeServedHours = ,0A
,ProbationTypeCode = ,''A
,ProbationLengthCode = ,''A
,ProbationLengthYears = ,0A
,ProbationLengthMonths = ,0A
,ProbationLengthDays = ,ISNULL(DATEDIFF(DAY,C.ProbationStartDate,C.ProbationEndDate),0)A
,OBTSProbationLengthYears = ,0A
,OBTSProbationLengthMonths = ,0A
,OBTSProbationLengthDays = ,ISNULL(DATEDIFF(DAY,C.ProbationStartDate,C.ProbationEndDate),0)A
,CommunityControlYears = ,0A
,CommunityControlMonths = ,0A
,CommunityControlDays = ,0A
,OBTSCommunityControlYears = ,0A
,OBTSCommunityControlMonths = ,0A
,OBTSCommunityControlDays = ,0A
,EWHENISNULL(CS.License_Suspension_Days,0)>0THEN'1'ENDASDLActionCode--GBDI-755:Source:dbo.Case_Sentences:RemoveDriving_Privledges&BMV_PointsfieldsfromlatesttblCaseChargeConversionLogic = ,CA
,EWHENISNULL(CS.License_Suspension_Days,0)>0THEN'1'WHENISNULL(CS.Driving_Privledges,0)>0THEN'2'ELSE'0'ENDASDLActionCode = --,CA
,LicenseSuspendedCode--GBDI-815:Mapfromdbo.Traffif_Criminal_DispositiontheBMV_Susp_Class_IdtotblCaseCharge.LicenseSuspendedCodefield = ,L.CodeA
,LicenseSuspendedYears = ,0A
,LicenseSuspendedMonths = ,0A
,LicenseSuspendedDays = ,ISNULL(CS.License_Suspension_Days,0)A
,LicenseReceivedByCourt = ,0A
,OBTSLicenseSuspendedYears = ,0A
,OBTSLicenseSuspendedMonths = ,0A
,OBTSLicenseSuspendedDays = ,ISNULL(CS.License_Suspension_Days,0)A
,FineAmount = ,ISNULL(CS.Fine,0)A
,CourtCostAmount = ,0A
,RestitutionAmount = ,ISNULL(CS.Restitution_Amount,0)A
,SentenceProvision1 = ,''A
,SentenceProvision2 = ,''A
,SentenceProvision3 = ,''A
,SentenceProvision4 = ,''A
,SentenceProvision5 = ,''A
,SpecialSentenceProvision1 = ,''A
,SpecialSentenceProvision2 = ,''A
,SpecialSentenceProvision3 = ,''A
,SpecialSentenceProvision4 = ,''A
,SpecialSentenceProvision5 = ,''A
,SpecialSentenceProvision6 = ,''A
,SpecialSentenceProvision7 = ,''A
,DrugTraffickingTermYears = ,0A
,DrugTraffickingTermMonths = ,0A
,DrugTraffickingTermDays = ,0A
,OBTSDrugTraffickingTermYears = ,0A
,OBTSDrugTraffickingTermMonths = ,0A
,OBTSDrugTraffickingTermDays = ,0A
,CostOfSupervisionRate = ,0A
,CountyOfSupervision = ,0A
,CommunityServiceHours = ,ISNULL(CS.CS_Hours,0)A
,RestitutionID = ,0A
,PlaintiffAttorneyID = ,0A
,DefendantAttorneyID = ,ISNULL(C.DefendantAttorneyID,0)A
,TrialType = ,''A
,VerdictTypeCode = ,''A
,AppearanceTypeCode = ,''A
,DLRestrictedCode = ,''A
,LicenseRestrictedCode = ,''A
,LicenseRestrictedYears = ,0A
,LicenseRestrictedMonths = ,0A
,LicenseRestrictedDays = ,0A
,OBTSLicenseRestrictedYears = ,0A
,OBTSLicenseRestrictedMonths = ,0A
,OBTSLicenseRestrictedDays = ,0A
,FailureTermDays = ,0A
,FailureTermCreditTimeServed = ,0A
,GuidelinesWaived = ,0A
,DLReExam = ,0A
,IsDocketed = ,0A
,DocketSentencingChangesOnly = ,0A
,CaseProcessActionID = ,0A
,SentencingJudgeID = ,ISNULL(PJSNT.PartyID,0)A
,Commitment = ,''A
,FollowedBy = ,''A
,JudicialWarning = ,0A
,AlternativeCourtSanction = ,0A
,NonJudicial = ,0A
,ImpoundmentVIN = ,''A
,ImpoundmentNoticeDate = ,NULLA
,ImpoundmentPlateNumber = ,''A
,ImpoundmentVehicleYear = ,0A
,ImpoundmentVehicleMake = ,''A
,ImpoundmentVehicleModel = ,''A
,ImpoundmentVehicleColor = ,''A
,ImpoundmentDays = ,0A
,ImpoundmentOwnerID = ,0A
,ImpoundmentLienHolderID = ,0A
,VerdictDate = ,NULLA
,IDISchool = ,0A
,ChildRestraintSchool = ,0A
,CreateByUserID = ,C.CreateByUserIDA
,CreateDate = ,C.CreateDateA
,ModifyByUserID = ,C.ModifyByUserIDA
,ModifyDate = ,C.ModifyDateA
,OBTSErrorMessages = ,''A
,DispositionJudgeID = ,ISNULL(PJSNT.PartyID,0)A
,SentencingSchoolHours = ,0A
,DisposedByID = ,0A
,BookingNumber = ,''A
,RefNumber = ,CV.Case_Violation_IdA
,CommunityControlLengthCode = ,''A
,ProbationStartDate = ,C.ProbationStartDateA
,ConfinementStartDate = ,NULLA
,WaivedAttorney = ,0A
,MandateDate = ,NULLA
,AppealBondAmount = ,0A
,AmendedBondAmount = ,0A
,DirectFiling = ,0A
,RestitutionAmountSentencing = ,0A
,ComplaintNumber = ,ISNULL(LTRIM(RTRIM(TCC.Incident_Number)),'')A
,ChargePoints--GBDI-755:Source:dbo.Case_Sentences:RemoveDriving_Privledges&BMV_PointsfieldsfromlatesttblCaseChargeConversionLogic = ,ISNULL(TCD.Points_Assessed,0)A
,EWHENISNULL(TCD.Points_Assessed,0)>0THENTCD.Points_AssessedELSEISNULL(CS.BMV_Points,0)ENDASChargePoints = --,CA
,DLSuspensionStartDate = ,CS.License_Suspension_FromA
,DLSuspensionEndDate = ,CS.License_Suspension_ToA
,DLModifySuspensionStartDate = ,NULLA
,DLModifySuspensionEndDate = ,NULLA
,DLModificationCode = ,''A
,CourtStatuteModifiedReason = ,''A
,InitialEssentialFacts = ,''A
,ProsecutorEssentialFacts = ,''A
,CourtEssentialFacts = ,''A
,InitialEssentialFactID = ,0A
,ProsecutorEssentialFactID = ,0A
,CourtEssentialFactID = ,0A
,ProbationEndDate = ,C.ProbationEndDateA
